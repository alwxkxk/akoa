# 账号体系的设计
## 功能需求分析
此应用的账号体系所需要的功能包括（按重要性排序）：
- 注册、删除账号、登陆、注销
- token、修改密码、用户组体系
- 修改昵称、检测账号重名
- excel批量上传账号

## token
token是账号凭证。登陆成功后生成token并保存至redis（两条缓存，name->token,token->账号信息），response body中包含token并set-cookie，后面相关操作的请求都会检查cookie或header里的token有无效，有效才允许操作。
![token 生成与使用](http://on-img.com/chart_image/5a1eae54e4b0b3ee0575b5f6.png)
### token组成
为了能够通过name找到token,通过token找到name，所以每次登陆成功后都会在redis里生成两条缓存。每次登陆都会刷新token并且使旧的token失效，每个token的生存时间被设置为1小时。token里包含该用户的用户组信息，用于API请求时检验是否有权限。
```
name:'token'

token:{ //redis中的hash结构
 name:'name',
 create_time:'YY-MM-DD HH:mm:ss',
 group_id:4 
}
```


## 用户组体系
用户组分四个等级：
1. 游客：只有浏览功能
2. 注册用户：正常使用功能
3. 用户组管理员：对该用户组有管理权限
4. 超级管理员：拥有最高管理权限  
不同的用户组拥有不同的权限，每次操作都会由后台判断是否拥有权限进行该操作，前端可自行配置以对应不同的渲染。


